## 事务级别要素ACID

1. 原子性（Atomicity)
2. 一致性 (Consistency)
3. 隔离性 (Isolation)
4. 持久性 (Durability)


## 事务并发导致的问题

1. 脏读

事务A读取了事务B更新的数据，然后事务B回滚了，事务A读到的数据即是脏数据

2. 不可重复读

事务A多次读取统一数据，事务B在这过程中更新了数据，导致事务A多次读取同一数据时，结果不一致

3. 幻读

事务A对表进行更改时，事务B插入了一条记录，导致A事务结束后发现还有一条数据没有改过来，像发生幻觉一样

> 小结： 不可重复读侧重于修改，幻读侧重于新增或删除，解决不可重复读的问题需要锁行，解决幻读需要锁表

## 事务的四个隔离级别


| 隔离级别 | 脏读 | 不可重复读 | 幻读 |
| --- | --- | --- | --- |
| 读未提交 / read-uncommitted | 是 | 是 | 是  |
| 不可重复读 / read-committed | 否 | 是 | 是 |
| 可重复读 / repeatable-read | 否 | 否（使用版本控制） | 是 |
| 串行化 / serializable | 否 | 否 | 否  |


### MVCC 机制

MVCC机制下，读分为两种：

1. 快照读（读取历史版本）
在 repeatable-read 等级中，事务中执行 select 都是读取事务开启时的快照

2. 当前读 （读取最新版本）
insert,update,delete 都是属于当前读

### 补充

1. 事务级别为读已提交时，写数据只锁相应行
2. 事务级别越高，越能保证安全性和一致性，但并发性能降低
3. 串行化，读写都会锁整张表
